<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>가상공간
    </title>
    <script src="./three.js"></script>
    <script src="./OrbitControls.js"></script>

    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <div id="webgl-output"></div>
    <script>

        function init() {

            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera(
                45,
                window.innerWidth / window.innerHeight,
                0.1,
                10000
            );
            //const gui = new dat.GUI();


            var renderer = new THREE.WebGLRenderer();
            renderer.setClearColor(new THREE.Color(0x000000));
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.gammaInput = true;
            renderer.gammaOutput = true;

            const loader = new THREE.TextureLoader();

            //화면 마우스로 회전시키기
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            camera.position.set(-100, 100, 100);
            controls.update();

            //바닥
            const pgeometry = new THREE.PlaneGeometry(100, 100);
            const pmaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });
            const plane = new THREE.Mesh(pgeometry, pmaterial);
            plane.rotation.x = 1.5 * Math.PI
            plane.position.set(0, 0, 0)
            plane.receiveShadow = true;
            scene.add(plane);

            //벽
            wallmaping = loader.load("wall.jpeg");
            const wallmapingMaterial = new THREE.MeshStandardMaterial({
                map: wallmaping,
                normalmap: wallmaping,
                displacementMap: wallmaping,
                displacementScale: 0.2,
                displacementBias: -0.15
            });
            const pgeometry2 = new THREE.PlaneGeometry(100, 75);
            const wall1 = new THREE.Mesh(pgeometry2, wallmapingMaterial);
            wall1.rotation.x = 1.5 * Math.PI;
            wall1.position.set(0, -50, 37.5)
            wall1.receiveShadow = true;
            plane.add(wall1);

            const wall2 = new THREE.Mesh(pgeometry2, wallmapingMaterial);
            wall2.rotation.y = 1.5 * Math.PI;
            wall2.rotation.z = -1.5 * Math.PI;
            wall2.position.set(50, 0, 37.5)
            wall2.receiveShadow = true;
            plane.add(wall2);

            const wall3 = new THREE.Mesh(pgeometry2, wallmapingMaterial);
            wall3.rotation.x = -1.5 * Math.PI;
            wall3.position.set(0, 50, 37.5)
            wall3.receiveShadow = true;
            plane.add(wall3);

            const wall4 = new THREE.Mesh(pgeometry2, wallmapingMaterial);
            wall4.rotation.y = -1.5 * Math.PI;
            wall4.rotation.z = 1.5 * Math.PI;
            wall4.position.set(-50, 0, 37.5)
            wall4.receiveShadow = true;
            plane.add(wall4);

            //천장
            const cellgeometry = new THREE.PlaneGeometry(150, 150);
            const celling = new THREE.Mesh(pgeometry, wallmapingMaterial);
            celling.rotation.y = 3 * Math.PI;
            celling.position.set(0, 0, 75)
            celling.receiveShadow = true;
            plane.add(celling);

            //전구
            const sphgeo = new THREE.SphereGeometry(2, 20);
            const sphmat = new THREE.MeshBasicMaterial({ color: 0xcccc00 });
            const light_Sphere1 = new THREE.Mesh(sphgeo, sphmat);
            light_Sphere1.position.set(0, 0, .5);
            celling.add(light_Sphere1);
            light1 = new THREE.PointLight(0xffffff);
            light1.position.set(0, 0, 10);
            light1.shodowCameraLeft = 15;
            light1.shodowCameraRight = 15;
            light1.shodowCameraTop = 15;
            light1.shodowCameraBottom = 15;
            light1.castShadow = true;
            celling.add(light1);

            light2 = new THREE.AmbientLight(0xffffff,0.05);
            celling.add(light2);

            light3 = new THREE.HemisphereLight(0xffffff,0x333333,0.3);
            celling.add(light3);

            //책장 밑 1
            shellMaping = loader.load("shell.jpeg");
            shelfMapMaterial = new THREE.MeshStandardMaterial({
                map: shellMaping,
                normalmap: shellMaping,
                displacementMap: shellMaping,
                displacementScale: 0.2,
                displacementBias: -0.15,
                roughnessMap: shellMaping,
                roughness: 0
            });
            cgeometry1 = new THREE.BoxGeometry(1, 30, 20);
            cgeometry2 = new THREE.BoxGeometry(10, 1, 20);

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(45, 39, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cgeometry3 = new THREE.BoxGeometry(10, 30, 1);
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);


            book1Maping = loader.load("book1.jpeg");
            book1MapMaterial = new THREE.MeshStandardMaterial({
                map: book1Maping,
                normalmap: book1Maping,
                displacementMap: book1Maping,
                displacementScale: 0.2,
                displacementBias: -0.15,
                roughnessMap: book1Maping,
                roughness: .85
            });

            book2Maping = loader.load("book2.jpeg");
            book2MapMaterial = new THREE.MeshStandardMaterial({
                map: book2Maping,
                normalmap: book2Maping,
                displacementMap: book2Maping,
                displacementScale: 0.2,
                displacementBias: -0.15,
                roughnessMap: book2Maping,
                roughness: .85
            });

            book3Maping = loader.load("book3.jpeg");
            book3MapMaterial = new THREE.MeshStandardMaterial({
                map: book3Maping,
                normalmap: book3Maping,
                displacementMap: book3Maping,
                displacementScale: 0.2,
                displacementBias: -0.15,
                roughnessMap: book3Maping,
                roughness: .85
            });
            book4Maping = loader.load("book4.jpeg");
            book4MapMaterial = new THREE.MeshStandardMaterial({
                map: book4Maping,
                normalmap: book4Maping,
                displacementMap: book4Maping,
                displacementScale: 0.2,
                displacementBias: -0.15,
                roughnessMap: book4Maping,
                roughness: .85
            });

            bgeometry = new THREE.BoxGeometry(5, 7, 0.5);
            bmaterial = new THREE.MeshPhongMaterial({ color: 0x964b00 });
            b2geometry = new THREE.BoxGeometry(5, 7, 1);
            b2material = new THREE.MeshPhongMaterial({ color: 0xdddddd });
            b3geometry = new THREE.BoxGeometry(7, 1.5, 5);
            b4geometry = new THREE.BoxGeometry(7, 10, 1.5);
            b3material = new THREE.MeshPhongMaterial({ color: 0xaabb88 });

            //책1
            book = new THREE.Mesh(bgeometry, bmaterial);
            book.position.set(-2, 14, -8);
            book.rotation.x = 72;
            book.castShadow = true;
            book.receiveShadow = true;
            bookshelf.add(book);

            //책2
            for(var step = 0; step < 10; step++){
                book2 = new THREE.Mesh(b2geometry, book1MapMaterial);
                book2.position.set(-2, 24, 8.5-(step*1.1));
                book2.castShadow = true;
                book2.receiveShadow = true;
                bookshelf.add(book2);
            }



            //책장 밑 2

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(45, 18, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);

            //책1
            for(var step = 0; step < 20; step++){
                book = new THREE.Mesh(bgeometry, book2MapMaterial);
                book.position.set(-2, 14-step*0.055, -8 + step*0.6);
                book.rotation.x = 72-step*0.03;
                book.castShadow = true;
                book.receiveShadow = true;
                bookshelf.add(book);
            }

            //책2
            book2 = new THREE.Mesh(b2geometry, b2material);
            book2.position.set(-2, 24, 8.5);
            book2.castShadow = true;
            book2.receiveShadow = true;
            bookshelf.add(book2);

            //책3
            book3 = new THREE.Mesh(b2geometry, b3material);
            book3.position.set(-2, 23.5, 5.4);
            book3.rotation.x = 7;
            book3.castShadow = true;
            book3.receiveShadow = true;
            bookshelf.add(book3);




            //책장 밑 3

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(44, -3, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);

            //책1
            book = new THREE.Mesh(bgeometry, bmaterial);
            book.position.set(-2, 14, -8);
            book.rotation.x = 72;
            book.castShadow = true;
            book.receiveShadow = true;
            bookshelf.add(book);

            //책2
            book2 = new THREE.Mesh(b2geometry, b2material);
            book2.position.set(-2, 24, 8.5);
            book2.castShadow = true;
            book2.receiveShadow = true;
            bookshelf.add(book2);

            //책3
            book4 = new THREE.Mesh(b3geometry, b3material);
            book4.position.set(-3, 21.25, -3);
            book4.castShadow = true;
            book4.receiveShadow = true;
            bookshelf.add(book4);

            //책4
            book4 = new THREE.Mesh(b3geometry, b3material);
            book4.position.set(-3, 22.85, -3);
            book4.castShadow = true;
            book4.receiveShadow = true;
            bookshelf.add(book4);

            //책장 밑 4
            

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(-15, 39, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.rotation.y = -3 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);



            //책1
            book = new THREE.Mesh(bgeometry, bmaterial);
            book.position.set(-2, 14, -8);
            book.rotation.x = 72;
            book.castShadow = true;
            book.receiveShadow = true;
            bookshelf.add(book);

            //책2
            for (var step = 0; step < 10; step++) {
                book2 = new THREE.Mesh(b2geometry, book1MapMaterial);
                book2.position.set(-2, 24, 8.5 - (step * 1.1));
                book2.castShadow = true;
                book2.receiveShadow = true;
                bookshelf.add(book2);
            }



            //책장 밑 5

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(-15, 18, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.rotation.y = -3 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);

            //책1
            for (var step = 0; step < 20; step++) {
                book = new THREE.Mesh(bgeometry, book2MapMaterial);
                book.position.set(-2, 14 - step * 0.055, -8 + step * 0.6);
                book.rotation.x = 72 - step * 0.03;
                book.castShadow = true;
                book.receiveShadow = true;
                bookshelf.add(book);
            }

            //책2
            book2 = new THREE.Mesh(b2geometry, b2material);
            book2.position.set(-2, 24, 8.5);
            book2.castShadow = true;
            book2.receiveShadow = true;
            bookshelf.add(book2);

            //책3
            book3 = new THREE.Mesh(b2geometry, b3material);
            book3.position.set(-2, 23.5, 5.4);
            book3.rotation.x = 7;
            book3.castShadow = true;
            book3.receiveShadow = true;
            bookshelf.add(book3);




            //책장 밑 6

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(-15, -3, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.rotation.y = -3 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);

            //책1
            book = new THREE.Mesh(bgeometry, bmaterial);
            book.position.set(-2, 14, -8);
            book.rotation.x = 72;
            book.castShadow = true;
            book.receiveShadow = true;
            bookshelf.add(book);

            //책2
            book2 = new THREE.Mesh(b2geometry, b2material);
            book2.position.set(-2, 24, 8.5);
            book2.castShadow = true;
            book2.receiveShadow = true;
            bookshelf.add(book2);

            //책3
            book4 = new THREE.Mesh(b3geometry, b3material);
            book4.position.set(0, 21.25, -6);
            book4.castShadow = true;
            book4.receiveShadow = true;
            bookshelf.add(book4);


            //책장 밑 7            

            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(-31, 44, 1);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.rotation.y = -1.5 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);

            //책장 뒷면
            cube = new THREE.Mesh(cgeometry1, shelfMapMaterial);
            cube.position.set(4.5, 14, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            bookshelf.add(cube);
            //선반1
            cube3 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube3.position.set(0, 10, 0);
            cube3.castShadow = true;
            cube3.receiveShadow = true;
            bookshelf.add(cube3);
            //선반2
            cube6 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube6.position.set(0, 20, 0);
            cube6.castShadow = true;
            cube6.receiveShadow = true;
            bookshelf.add(cube6);
            //책장 천장
            cube7 = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            cube7.position.set(0, 29, 0);
            cube7.castShadow = true;
            cube7.receiveShadow = true;
            bookshelf.add(cube7);
            //책장 옆면1
            cube4 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube4.position.set(0, 14, 9.5);
            cube4.castShadow = true;
            cube4.receiveShadow = true;
            bookshelf.add(cube4);

            //책장 옆면2
            cube5 = new THREE.Mesh(cgeometry3, shelfMapMaterial);
            cube5.position.set(0, 14, -9.5);
            cube5.castShadow = true;
            cube5.receiveShadow = true;
            bookshelf.add(cube5);

            //책1
            book = new THREE.Mesh(bgeometry, bmaterial);
            book.position.set(-2, 14, -8);
            book.rotation.x = 72;
            book.castShadow = true;
            book.receiveShadow = true;
            bookshelf.add(book);

            //책2
            for (var step = 0; step < 10; step++) {
                book2 = new THREE.Mesh(b2geometry, book1MapMaterial);
                book2.position.set(-2, 24, 8.5 - (step * 1.1));
                book2.castShadow = true;
                book2.receiveShadow = true;
                bookshelf.add(book2);
            }

            for (var step = 0; step < 10; step++) {
                book2 = new THREE.Mesh(b2geometry, book4MapMaterial);
                book2.position.set(-2, 4, 8.5 - (step * 1.1));
                book2.castShadow = true;
                book2.receiveShadow = true;
                bookshelf.add(book2);
            }

            //선반1
            bookshelf = new THREE.Mesh(cgeometry2, shelfMapMaterial);
            bookshelf.position.set(30, -45.5, 30);
            bookshelf.rotation.x = -1.5 * Math.PI
            bookshelf.rotation.y = -1.5 * Math.PI
            bookshelf.castShadow = true;
            bookshelf.receiveShadow = true;
            plane.add(bookshelf);


            trimat = new THREE.CylinderGeometry(10,10,1,3,1,false,0,1.6);
            tri1 = new THREE.Mesh(trimat,shelfMapMaterial);
            tri1.rotation.z = -1.5 * Math.PI
            tri1.position.set(39.5,-50.5,30);
            tri1.castShadow = true;
            tri1.receiveShadow = true;
            plane.add(tri1)

            tri2 = new THREE.Mesh(trimat, shelfMapMaterial);
            tri2.rotation.z = -1.5 * Math.PI
            tri2.position.set(20.5, -50.5, 30);
            tri2.castShadow = true;
            tri2.receiveShadow = true;
            plane.add(tri2)

            for (var step = 0; step < 10; step++) {
                book2 = new THREE.Mesh(b4geometry, book4MapMaterial);
                book2.position.set(3.5, 1.25+(step*1.5*1.05), 5.5);
                book2.rotation.x = -1.5 * Math.PI
                book2.castShadow = true;
                book2.receiveShadow = true;
                tri1.add(book2);
            }

            document.getElementById("webgl-output").appendChild(renderer.domElement);
            renderScene();

            function renderScene() {
                controls.update()
                requestAnimationFrame(renderScene);
                renderer.render(scene, camera);

            }
        }

        
        window.onload = init;
        window.addEventListener('resize', onRisize, false);
    </script>
</body>

</html>